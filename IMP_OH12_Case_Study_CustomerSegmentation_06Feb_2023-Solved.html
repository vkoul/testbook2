
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Imperial Business Analytics OH: WK13- Clustering &#8212; Case Study Book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Case Study Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown-notebooks.html">
   Notebooks with MyST Markdown
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="IMP_Vikesh_OH3_28Nov.html">
   Imperial Business Analytics- üêç Python Primer 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="IMP_BA_OH4.html">
   Imperial Business Analytics- üêç Python Primer 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="IMP_BA_OH5--Class.html">
   Imperial Business Analytics- üêç Python Primer 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="IMP_Vikesh_OH7_02Jan2023_Data_analyst-PartiallySolved.html">
   Imperial Business Analytics- WK8- Estimators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="IMP_Vikesh_OH8_10Jan-23_Complete.html">
   Imperial Business Analytics OH: WK9- Correlation &amp; Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="IMP_Vikesh_OH9_16Jan-23_Conversion_Case%20Study_final.html">
   Imperial Business Analytics: WK10- ML and K-NN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="IMP-BA-M11-PredictingCancellation_23Jan-Solved.html">
   Imperial Business Analytics OH: WK11- Classification and Regression Trees
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FIMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Imperial Business Analytics OH: WK13- Clustering
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#oh-agenda">
   OH Agenda üìù
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#case-study-customer-segmentation-and-targeting">
   Case Study üìì: Customer Segmentation and Targeting
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-import-modules-and-data-font">
     <font color="darkred">
      Import modules and data
     </font>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-data-inspection-font">
     <font color="darkred">
      Data Inspection
     </font>
     üîçüìä
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#font-color-darkred-numerical-inspection-and-summaries-font">
       <font color="darkred">
        Numerical inspection and summaries
       </font>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-eda-font">
     <font color="darkred">
      EDA
     </font>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#univariate-analysis">
       Univariate Analysis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bivariate-analysis">
       Bivariate Analysis
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-data-prep-for-modeling-font">
     <font color="darkred">
      Data Prep for Modeling
     </font>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scaling-data">
       Scaling Data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#convert-categorical-value-to-numerical">
       Convert categorical value to numerical
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-model-building-font">
     <font color="darkred">
      Model building
     </font>
     üí•‚ö°
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#clustering-using-kmeans">
       Clustering using KMeans
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optimal-clusters-using-elbow-method">
       Optimal Clusters using Elbow Method
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cluster-level-analysis">
     Cluster Level Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reference-material">
   Reference material üìö
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Imperial Business Analytics OH: WK13- Clustering</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Imperial Business Analytics OH: WK13- Clustering
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#oh-agenda">
   OH Agenda üìù
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#case-study-customer-segmentation-and-targeting">
   Case Study üìì: Customer Segmentation and Targeting
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-import-modules-and-data-font">
     <font color="darkred">
      Import modules and data
     </font>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-data-inspection-font">
     <font color="darkred">
      Data Inspection
     </font>
     üîçüìä
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#font-color-darkred-numerical-inspection-and-summaries-font">
       <font color="darkred">
        Numerical inspection and summaries
       </font>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-eda-font">
     <font color="darkred">
      EDA
     </font>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#univariate-analysis">
       Univariate Analysis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bivariate-analysis">
       Bivariate Analysis
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-data-prep-for-modeling-font">
     <font color="darkred">
      Data Prep for Modeling
     </font>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scaling-data">
       Scaling Data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#convert-categorical-value-to-numerical">
       Convert categorical value to numerical
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#font-color-darkred-model-building-font">
     <font color="darkred">
      Model building
     </font>
     üí•‚ö°
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#clustering-using-kmeans">
       Clustering using KMeans
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optimal-clusters-using-elbow-method">
       Optimal Clusters using Elbow Method
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cluster-level-analysis">
     Cluster Level Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reference-material">
   Reference material üìö
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="alert alert-block alert-success">
<section class="tex2jax_ignore mathjax_ignore" id="imperial-business-analytics-oh-wk13-clustering">
<h1>Imperial Business Analytics OH: WK13- Clustering<a class="headerlink" href="#imperial-business-analytics-oh-wk13-clustering" title="Permalink to this headline">#</a></h1>
<p>üë®‚Äçüè´ <strong>Vikesh K</strong><br />
üìÖ <strong>[06-Feb-2023]</strong> ‚è∞ <strong>7pm UTC</strong><br />
<strong>Office Hour # 12</strong></p>
</div><div class="alert alert-block alert-danger">
</section>
<section class="tex2jax_ignore mathjax_ignore" id="oh-agenda">
<h1>OH Agenda üìù<a class="headerlink" href="#oh-agenda" title="Permalink to this headline">#</a></h1>
<p>We will cover:</p>
<ul class="simple">
<li><p>Customer Segmentation</p></li>
<li><p>Action Plan\</p></li>
<li><p>EDA</p></li>
<li><p>Data Preprocessing</p></li>
<li><p>Modeling</p></li>
</ul>
 </div><h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Imperial-Business-Analytics-OH:-WK13--Clustering" data-toc-modified-id="Imperial-Business-Analytics-OH:-WK13--Clustering-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Imperial Business Analytics OH: WK13- Clustering</a></span></li><li><span><a href="#OH-Agenda-üìù" data-toc-modified-id="OH-Agenda-üìù-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>OH Agenda üìù</a></span></li><li><span><a href="#Case-Study-üìì:-Customer-Segmentation-and-Targeting" data-toc-modified-id="Case-Study-üìì:-Customer-Segmentation-and-Targeting-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Case Study üìì: Customer Segmentation and Targeting</a></span><ul class="toc-item"><li><span><a href="#-Import-modules-and-data-" data-toc-modified-id="-Import-modules-and-data--3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span><font color="darkred"> Import modules and data </font></a></span></li><li><span><a href="#-Data-Inspectionüîçüìä" data-toc-modified-id="-Data-Inspectionüîçüìä-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span><font color="darkred"> Data Inspection</font>üîçüìä</a></span><ul class="toc-item"><li><span><a href="#-Numerical-inspection-and-summaries-" data-toc-modified-id="-Numerical-inspection-and-summaries--3.2.1"><span class="toc-item-num">3.2.1&nbsp;&nbsp;</span><font color="darkred"> Numerical inspection and summaries </font></a></span></li></ul></li><li><span><a href="#-EDA-" data-toc-modified-id="-EDA--3.3"><span class="toc-item-num">3.3&nbsp;&nbsp;</span><font color="darkred"> EDA </font></a></span><ul class="toc-item"><li><span><a href="#Univariate-Analysis" data-toc-modified-id="Univariate-Analysis-3.3.1"><span class="toc-item-num">3.3.1&nbsp;&nbsp;</span>Univariate Analysis</a></span></li><li><span><a href="#Bivariate-Analysis" data-toc-modified-id="Bivariate-Analysis-3.3.2"><span class="toc-item-num">3.3.2&nbsp;&nbsp;</span>Bivariate Analysis</a></span></li></ul></li><li><span><a href="#-Data-Prep-for-Modeling-" data-toc-modified-id="-Data-Prep-for-Modeling--3.4"><span class="toc-item-num">3.4&nbsp;&nbsp;</span><font color="darkred"> Data Prep for Modeling </font></a></span><ul class="toc-item"><li><span><a href="#Scaling-Data" data-toc-modified-id="Scaling-Data-3.4.1"><span class="toc-item-num">3.4.1&nbsp;&nbsp;</span>Scaling Data</a></span></li><li><span><a href="#Convert-categorical-value-to-numerical" data-toc-modified-id="Convert-categorical-value-to-numerical-3.4.2"><span class="toc-item-num">3.4.2&nbsp;&nbsp;</span>Convert categorical value to numerical</a></span></li></ul></li><li><span><a href="#-Model-building--üí•‚ö°" data-toc-modified-id="-Model-building--üí•‚ö°-3.5"><span class="toc-item-num">3.5&nbsp;&nbsp;</span><font color="darkred"> Model building </font> üí•‚ö°</a></span><ul class="toc-item"><li><span><a href="#Clustering-using-KMeans" data-toc-modified-id="Clustering-using-KMeans-3.5.1"><span class="toc-item-num">3.5.1&nbsp;&nbsp;</span>Clustering using <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html" rel="nofollow" target="_blank">KMeans</a></a></span></li><li><span><a href="#Optimal-Clusters-using-Elbow-Method" data-toc-modified-id="Optimal-Clusters-using-Elbow-Method-3.5.2"><span class="toc-item-num">3.5.2&nbsp;&nbsp;</span>Optimal Clusters using Elbow Method</a></span></li></ul></li><li><span><a href="#Cluster-Level-Analysis" data-toc-modified-id="Cluster-Level-Analysis-3.6"><span class="toc-item-num">3.6&nbsp;&nbsp;</span>Cluster Level Analysis</a></span></li></ul></li><li><span><a href="#Reference-material-üìö" data-toc-modified-id="Reference-material-üìö-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Reference material üìö</a></span></li></ul></div><div class="alert alert-block alert-success">
</section>
<section class="tex2jax_ignore mathjax_ignore" id="case-study-customer-segmentation-and-targeting">
<h1>Case Study üìì: Customer Segmentation and Targeting<a class="headerlink" href="#case-study-customer-segmentation-and-targeting" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://docs.google.com/document/d/1AvUydV8er-qNNTwTlH8ITMLpX-29t14wc3wvFQX2goY/edit?usp=sharing">Case Study Link</a></p>
</div><section id="font-color-darkred-import-modules-and-data-font">
<h2><font color= darkred> Import modules and data </font><a class="headerlink" href="#font-color-darkred-import-modules-and-data-font" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data manipulation</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># data viz</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;fivethirtyeight&quot;</span><span class="p">)</span> <span class="c1"># styling the charts</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Load Data</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/vkoul/data/main/misc/household_data.csv&#39;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-darkred-data-inspection-font">
<h2><font color= darkred> Data Inspection</font>üîçüìä<a class="headerlink" href="#font-color-darkred-data-inspection-font" title="Permalink to this headline">#</a></h2>
<section id="font-color-darkred-numerical-inspection-and-summaries-font">
<h3><font color= darkred> Numerical inspection and summaries </font><a class="headerlink" href="#font-color-darkred-numerical-inspection-and-summaries-font" title="Permalink to this headline">#</a></h3>
<p><strong>Data Inspect</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(15000, 11)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>householdID</th>
      <th>total_ppl</th>
      <th>own_rent</th>
      <th>square_foot</th>
      <th>household_income</th>
      <th>number_pets</th>
      <th>county</th>
      <th>entertainment_spend_est</th>
      <th>travel_spend_est</th>
      <th>under_12</th>
      <th>LL_passholder</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>own</td>
      <td>3309</td>
      <td>80464</td>
      <td>1</td>
      <td>York</td>
      <td>2535</td>
      <td>2842</td>
      <td>1</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>3</td>
      <td>own</td>
      <td>3814</td>
      <td>47696</td>
      <td>2</td>
      <td>York</td>
      <td>2913</td>
      <td>3938</td>
      <td>1</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>rent</td>
      <td>2592</td>
      <td>108256</td>
      <td>2</td>
      <td>Cumberland</td>
      <td>1986</td>
      <td>3687</td>
      <td>2</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2</td>
      <td>own</td>
      <td>2628</td>
      <td>68064</td>
      <td>1</td>
      <td>Cumberland</td>
      <td>2505</td>
      <td>2826</td>
      <td>1</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>3</td>
      <td>rent</td>
      <td>2442</td>
      <td>62786</td>
      <td>2</td>
      <td>Sagadahoc</td>
      <td>3541</td>
      <td>1344</td>
      <td>2</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 15000 entries, 0 to 14999
Data columns (total 11 columns):
 #   Column                   Non-Null Count  Dtype 
---  ------                   --------------  ----- 
 0   householdID              15000 non-null  int64 
 1   total_ppl                15000 non-null  int64 
 2   own_rent                 15000 non-null  object
 3   square_foot              15000 non-null  int64 
 4   household_income         15000 non-null  int64 
 5   number_pets              15000 non-null  int64 
 6   county                   15000 non-null  object
 7   entertainment_spend_est  15000 non-null  int64 
 8   travel_spend_est         15000 non-null  int64 
 9   under_12                 15000 non-null  int64 
 10  LL_passholder            15000 non-null  object
dtypes: int64(8), object(3)
memory usage: 1.3+ MB
</pre></div>
</div>
</div>
</div>
<p><strong>Missing values check</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>householdID                0
total_ppl                  0
own_rent                   0
square_foot                0
household_income           0
number_pets                0
county                     0
entertainment_spend_est    0
travel_spend_est           0
under_12                   0
LL_passholder              0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;householdID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="font-color-darkred-eda-font">
<h2><font color= darkred> EDA </font><a class="headerlink" href="#font-color-darkred-eda-font" title="Permalink to this headline">#</a></h2>
<section id="univariate-analysis">
<h3>Univariate Analysis<a class="headerlink" href="#univariate-analysis" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_ppl</th>
      <th>square_foot</th>
      <th>household_income</th>
      <th>number_pets</th>
      <th>entertainment_spend_est</th>
      <th>travel_spend_est</th>
      <th>under_12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
      <td>15000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.130067</td>
      <td>3118.928600</td>
      <td>72555.562067</td>
      <td>1.509200</td>
      <td>2651.515000</td>
      <td>3556.169400</td>
      <td>1.766533</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.891592</td>
      <td>815.925967</td>
      <td>18758.466766</td>
      <td>0.790163</td>
      <td>766.499083</td>
      <td>599.815642</td>
      <td>0.732072</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>370.000000</td>
      <td>6801.000000</td>
      <td>0.000000</td>
      <td>193.000000</td>
      <td>924.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.000000</td>
      <td>2506.000000</td>
      <td>60007.000000</td>
      <td>1.000000</td>
      <td>2140.000000</td>
      <td>3173.750000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>3042.000000</td>
      <td>72512.000000</td>
      <td>2.000000</td>
      <td>2650.000000</td>
      <td>3573.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>3738.000000</td>
      <td>85201.750000</td>
      <td>2.000000</td>
      <td>3158.250000</td>
      <td>3961.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.000000</td>
      <td>6081.000000</td>
      <td>145381.000000</td>
      <td>4.000000</td>
      <td>5541.000000</td>
      <td>5908.000000</td>
      <td>4.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>own_rent</th>
      <th>county</th>
      <th>LL_passholder</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>15000</td>
      <td>15000</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>top</th>
      <td>own</td>
      <td>Cumberland</td>
      <td>No</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>11306</td>
      <td>8120</td>
      <td>8837</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">object_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">object_cols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;own_rent&#39;, &#39;county&#39;, &#39;LL_passholder&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">object_cols</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>own_rent
</pre></div>
</div>
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_23_1.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_23_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>county
</pre></div>
</div>
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_23_3.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_23_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LL_passholder
</pre></div>
</div>
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_23_5.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_23_5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_24_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_24_0.png" />
</div>
</div>
</section>
<section id="bivariate-analysis">
<h3>Bivariate Analysis<a class="headerlink" href="#bivariate-analysis" title="Permalink to this headline">#</a></h3>
<p><strong>Numerical Summaries</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;county&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>Cumberland</th>
      <th>Sagadahoc</th>
      <th>York</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">total_ppl</th>
      <th>count</th>
      <td>8120.000000</td>
      <td>1265.000000</td>
      <td>5615.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.126724</td>
      <td>3.098024</td>
      <td>3.142119</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.889276</td>
      <td>0.879552</td>
      <td>0.897547</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.000000</td>
      <td>6.000000</td>
      <td>7.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">square_foot</th>
      <th>count</th>
      <td>8120.000000</td>
      <td>1265.000000</td>
      <td>5615.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2683.856404</td>
      <td>2366.762055</td>
      <td>3917.553161</td>
    </tr>
    <tr>
      <th>std</th>
      <td>524.159125</td>
      <td>547.527828</td>
      <td>524.063740</td>
    </tr>
    <tr>
      <th>min</th>
      <td>370.000000</td>
      <td>614.000000</td>
      <td>1950.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2333.000000</td>
      <td>1986.000000</td>
      <td>3566.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2679.000000</td>
      <td>2392.000000</td>
      <td>3914.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3037.250000</td>
      <td>2741.000000</td>
      <td>4279.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5140.000000</td>
      <td>4050.000000</td>
      <td>6081.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">household_income</th>
      <th>count</th>
      <td>8120.000000</td>
      <td>1265.000000</td>
      <td>5615.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>72758.319212</td>
      <td>66373.092490</td>
      <td>73655.194479</td>
    </tr>
    <tr>
      <th>std</th>
      <td>18595.310178</td>
      <td>19212.421082</td>
      <td>18629.460212</td>
    </tr>
    <tr>
      <th>min</th>
      <td>7181.000000</td>
      <td>6801.000000</td>
      <td>11770.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>60282.750000</td>
      <td>53176.000000</td>
      <td>61051.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>72616.000000</td>
      <td>66116.000000</td>
      <td>73634.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>85324.000000</td>
      <td>78665.000000</td>
      <td>86231.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>137489.000000</td>
      <td>120402.000000</td>
      <td>145381.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">number_pets</th>
      <th>count</th>
      <td>8120.000000</td>
      <td>1265.000000</td>
      <td>5615.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.515887</td>
      <td>1.458498</td>
      <td>1.510953</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.791315</td>
      <td>0.786592</td>
      <td>0.789027</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">entertainment_spend_est</th>
      <th>count</th>
      <td>8120.000000</td>
      <td>1265.000000</td>
      <td>5615.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2626.450739</td>
      <td>2601.719368</td>
      <td>2698.979519</td>
    </tr>
    <tr>
      <th>std</th>
      <td>762.493221</td>
      <td>762.602445</td>
      <td>770.849493</td>
    </tr>
    <tr>
      <th>min</th>
      <td>193.000000</td>
      <td>276.000000</td>
      <td>203.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2120.000000</td>
      <td>2088.000000</td>
      <td>2188.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2616.000000</td>
      <td>2606.000000</td>
      <td>2695.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3134.000000</td>
      <td>3076.000000</td>
      <td>3211.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5541.000000</td>
      <td>5026.000000</td>
      <td>5385.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">travel_spend_est</th>
      <th>count</th>
      <td>8120.000000</td>
      <td>1265.000000</td>
      <td>5615.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3480.488300</td>
      <td>2717.532806</td>
      <td>3854.549777</td>
    </tr>
    <tr>
      <th>std</th>
      <td>511.305216</td>
      <td>538.424416</td>
      <td>511.918423</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1552.000000</td>
      <td>924.000000</td>
      <td>2018.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3140.000000</td>
      <td>2375.000000</td>
      <td>3502.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3472.500000</td>
      <td>2713.000000</td>
      <td>3849.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3825.000000</td>
      <td>3058.000000</td>
      <td>4209.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5356.000000</td>
      <td>4626.000000</td>
      <td>5908.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">under_12</th>
      <th>count</th>
      <td>8120.000000</td>
      <td>1265.000000</td>
      <td>5615.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.762808</td>
      <td>1.767589</td>
      <td>1.771683</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.732068</td>
      <td>0.725699</td>
      <td>0.733602</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df.groupby(&#39;own_rent&#39;).describe().T</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Graphical Summaries</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;entertainment_spend_est&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_30_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_30_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;entertainment_spend_est&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;own_rent&quot;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_31_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_31_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.pairplot(data=df, hue=&quot;county&quot;); #takes time to run</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.swarmplot(data=df, x=&quot;own_rent&quot;, y = &quot;entertainment_spend_est&quot;, hue=&quot;county&quot;); # takes time to run</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Correlation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span> <span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_35_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_35_0.png" />
</div>
</div>
</section>
</section>
<section id="font-color-darkred-data-prep-for-modeling-font">
<h2><font color= darkred> Data Prep for Modeling </font><a class="headerlink" href="#font-color-darkred-data-prep-for-modeling-font" title="Permalink to this headline">#</a></h2>
<section id="scaling-data">
<h3>Scaling Data<a class="headerlink" href="#scaling-data" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://stats.stackexchange.com/questions/89809/is-it-important-to-scale-data-before-clustering">Why Scaling is important for Clustering</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df.head()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Selecting only the numerical columns</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_numerical</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span>
<span class="n">df_numerical</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_ppl</th>
      <th>square_foot</th>
      <th>household_income</th>
      <th>number_pets</th>
      <th>entertainment_spend_est</th>
      <th>travel_spend_est</th>
      <th>under_12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>3309</td>
      <td>80464</td>
      <td>1</td>
      <td>2535</td>
      <td>2842</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>3814</td>
      <td>47696</td>
      <td>2</td>
      <td>2913</td>
      <td>3938</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Standardizing</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="c1"># intiate </span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="c1"># fit and transform </span>
<span class="n">df_numerical_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_numerical</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df_numerical_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.ndarray
</pre></div>
</div>
</div>
</div>
<p><strong>Converting to Pandas and Visualizing</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_numerical_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_numerical_scaled</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">df_numerical</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_numerical</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">subplots</span> <span class="o">=</span> <span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_46_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_46_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_numerical_scaled</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">subplots</span> <span class="o">=</span> <span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_47_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_47_0.png" />
</div>
</div>
<p><strong>Replacing the original values with scaled values</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_cols</span> <span class="o">=</span> <span class="n">df_numerical</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orig</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">num_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_numerical_scaled</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_ppl</th>
      <th>own_rent</th>
      <th>square_foot</th>
      <th>household_income</th>
      <th>number_pets</th>
      <th>county</th>
      <th>entertainment_spend_est</th>
      <th>travel_spend_est</th>
      <th>under_12</th>
      <th>LL_passholder</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.145886</td>
      <td>own</td>
      <td>0.232960</td>
      <td>0.421607</td>
      <td>-0.644446</td>
      <td>York</td>
      <td>-0.152014</td>
      <td>-1.190688</td>
      <td>-1.047109</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.145886</td>
      <td>own</td>
      <td>0.851909</td>
      <td>-1.325289</td>
      <td>0.621159</td>
      <td>York</td>
      <td>0.341153</td>
      <td>0.636601</td>
      <td>-1.047109</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.145886</td>
      <td>rent</td>
      <td>-0.645826</td>
      <td>1.903227</td>
      <td>0.621159</td>
      <td>Cumberland</td>
      <td>-0.868282</td>
      <td>0.218125</td>
      <td>0.318923</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.267513</td>
      <td>own</td>
      <td>-0.601703</td>
      <td>-0.239450</td>
      <td>-0.644446</td>
      <td>Cumberland</td>
      <td>-0.191155</td>
      <td>-1.217364</td>
      <td>-1.047109</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.145886</td>
      <td>rent</td>
      <td>-0.829672</td>
      <td>-0.520825</td>
      <td>0.621159</td>
      <td>Sagadahoc</td>
      <td>1.160490</td>
      <td>-3.688205</td>
      <td>0.318923</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="convert-categorical-value-to-numerical">
<h3>Convert categorical value to numerical<a class="headerlink" href="#convert-categorical-value-to-numerical" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">drop_first</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_ppl</th>
      <th>square_foot</th>
      <th>household_income</th>
      <th>number_pets</th>
      <th>entertainment_spend_est</th>
      <th>travel_spend_est</th>
      <th>under_12</th>
      <th>own_rent_rent</th>
      <th>county_Sagadahoc</th>
      <th>county_York</th>
      <th>LL_passholder_Yes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.145886</td>
      <td>0.232960</td>
      <td>0.421607</td>
      <td>-0.644446</td>
      <td>-0.152014</td>
      <td>-1.190688</td>
      <td>-1.047109</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.145886</td>
      <td>0.851909</td>
      <td>-1.325289</td>
      <td>0.621159</td>
      <td>0.341153</td>
      <td>0.636601</td>
      <td>-1.047109</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="font-color-darkred-model-building-font">
<h2><font color= darkred> Model building </font> üí•‚ö°<a class="headerlink" href="#font-color-darkred-model-building-font" title="Permalink to this headline">#</a></h2>
<section id="clustering-using-kmeans">
<h3>Clustering using <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html">KMeans</a><a class="headerlink" href="#clustering-using-kmeans" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="optimal-clusters-using-elbow-method">
<h3>Optimal Clusters using Elbow Method<a class="headerlink" href="#optimal-clusters-using-elbow-method" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sse</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">sse</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span>
    
<span class="c1">#Viz    </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;The Elbow Method for optimal k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;SSE&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sse</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">y</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sse</span><span class="o">.</span><span class="n">values</span><span class="p">()));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_60_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_60_0.png" />
</div>
</div>
<p><strong>Understand the change in Elbow Methods</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interia_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sse</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sse</span><span class="p">)))</span>
<span class="n">interia_df</span> <span class="o">=</span> <span class="n">interia_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="n">interia_df</span><span class="p">[</span><span class="s1">&#39;pct_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interia_df</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="n">interia_df</span> <span class="o">=</span> <span class="n">interia_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">interia_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>0</th>
      <th>pct_change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>100361.820228</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>92497.406894</td>
      <td>7.84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>87113.872506</td>
      <td>5.82</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>83430.557557</td>
      <td>4.23</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>79973.591814</td>
      <td>4.14</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>77214.974768</td>
      <td>3.45</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>74556.388356</td>
      <td>3.44</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>72283.143401</td>
      <td>3.05</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10</td>
      <td>70193.309446</td>
      <td>2.89</td>
    </tr>
    <tr>
      <th>9</th>
      <td>11</td>
      <td>68631.007490</td>
      <td>2.23</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># plot the chart</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">interia_df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">interia_df</span><span class="p">[</span><span class="s1">&#39;pct_change&#39;</span><span class="p">])</span>

<span class="c1"># format chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Percentage change in inertia across k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage change&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_63_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_63_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># intiate the model </span>
<span class="n">kmean</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># fit the model </span>
<span class="n">kmean</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KMeans(n_clusters=5, random_state=0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmean</span><span class="o">.</span><span class="n">labels_</span>
<span class="nb">len</span><span class="p">(</span><span class="n">kmean</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orig</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmean</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orig</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_ppl</th>
      <th>own_rent</th>
      <th>square_foot</th>
      <th>household_income</th>
      <th>number_pets</th>
      <th>county</th>
      <th>entertainment_spend_est</th>
      <th>travel_spend_est</th>
      <th>under_12</th>
      <th>LL_passholder</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>own</td>
      <td>3309</td>
      <td>80464</td>
      <td>1</td>
      <td>York</td>
      <td>2535</td>
      <td>2842</td>
      <td>1</td>
      <td>No</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>own</td>
      <td>3814</td>
      <td>47696</td>
      <td>2</td>
      <td>York</td>
      <td>2913</td>
      <td>3938</td>
      <td>1</td>
      <td>No</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="cluster-level-analysis">
<h2>Cluster Level Analysis<a class="headerlink" href="#cluster-level-analysis" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df_orig</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;cluster&#39;</span><span class="p">])</span>

<span class="n">grouped</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
<span class="s1">&#39;total_ppl&#39;</span> <span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> 
<span class="s1">&#39;square_foot&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
<span class="s1">&#39;household_income&#39;</span> <span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
<span class="s1">&#39;number_pets&#39;</span> <span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
<span class="s1">&#39;entertainment_spend_est&#39;</span> <span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
<span class="s1">&#39;travel_spend_est&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;count&#39;</span><span class="p">],</span>
<span class="s1">&#39;under_12&#39;</span> <span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>total_ppl</th>
      <th>square_foot</th>
      <th>household_income</th>
      <th>number_pets</th>
      <th>entertainment_spend_est</th>
      <th colspan="2" halign="left">travel_spend_est</th>
      <th>under_12</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>mean</th>
      <th>mean</th>
      <th>mean</th>
      <th>mean</th>
      <th>mean</th>
      <th>count</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>cluster</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.81</td>
      <td>2623.04</td>
      <td>70051.28</td>
      <td>2.27</td>
      <td>2654.46</td>
      <td>3314.59</td>
      <td>3417</td>
      <td>1.60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.32</td>
      <td>3988.93</td>
      <td>68918.10</td>
      <td>1.51</td>
      <td>3054.80</td>
      <td>3934.48</td>
      <td>3172</td>
      <td>2.06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.26</td>
      <td>2746.49</td>
      <td>73767.24</td>
      <td>1.49</td>
      <td>2567.18</td>
      <td>3395.31</td>
      <td>2503</td>
      <td>2.38</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.79</td>
      <td>2601.36</td>
      <td>69663.25</td>
      <td>0.77</td>
      <td>2653.80</td>
      <td>3288.70</td>
      <td>3330</td>
      <td>1.58</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.66</td>
      <td>3735.89</td>
      <td>82910.00</td>
      <td>1.48</td>
      <td>2230.34</td>
      <td>3912.56</td>
      <td>2578</td>
      <td>1.27</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_orig</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;cluster&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;entertainment_spend_est&#39;</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="kc">None</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_70_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_70_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_orig</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;cluster&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;entertainment_spend_est&#39;</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="kc">None</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_71_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_71_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_orig</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;travel_spend_est&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;entertainment_spend_est&#39;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;cluster&#39;</span><span class="p">,</span> 
               <span class="n">size</span><span class="o">=</span><span class="s2">&quot;cluster&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;cluster&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_72_0.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_72_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">df_orig</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;cluster&quot;</span><span class="p">)</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x1dc1e6f5100&gt;
</pre></div>
</div>
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_73_1.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_73_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">df_orig</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;cluster&quot;</span><span class="p">,</span>  <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;cluster&#39;</span><span class="p">,</span><span class="n">palette</span> <span class="o">=</span> <span class="s2">&quot;deep&quot;</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">,</span> <span class="s1">&#39;travel_spend_est&#39;</span><span class="p">,</span> <span class="s1">&#39;entertainment_spend_est&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x1dc1e695400&gt;
</pre></div>
</div>
<img alt="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_74_1.png" src="_images/IMP_OH12_Case_Study_CustomerSegmentation_06Feb_2023-Solved_74_1.png" />
</div>
</div>
<div class="alert alert-block alert-success">
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="reference-material">
<h1>Reference material üìö<a class="headerlink" href="#reference-material" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/">Python Data Science Handbook</a>: good book for hands on practice and codes.</p></li>
<li><p><a class="reference external" href="https://www.statlearning.com/">ISLR</a>- good coverage of the theory</p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/clustering-on-numerical-and-categorical-features-6e0ebcf1cbad">Kmeans Categorical</a></p></li>
<li><p><a class="reference external" href="https://www.tomasbeuzen.com/post/clustering-mixed-data/">Clustering Mixed Data</a></p></li>
</ul>
</div></section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Vikesh<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>